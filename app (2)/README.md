## Развёртывание

1.  **Сборка и запуск контейнеров:**
    `docker compose up -d --build`
    Собирает образы и запускает контейнеры в фоновом режиме.

2.  **Создание миграции:**
    `docker compose run --rm php83-service php bin/console make:migration`
    Запускает контейнер с PHP и создает новую миграцию на основе изменений в модели данных.

3.  **Применение миграций:**
    `docker compose run --rm php83-service php bin/console doctrine:migrations:migrate`
    Применяет все миграции к базе данных.

docker compose run --rm php83-service php bin/console doctrine:migrations:migrate --env=test

4.  **Запуск тестов:**
    `docker compose run --rm php83-service php bin/phpunit`
    Запускает тесты внутри контейнера.

## Документация API

1.  **Получение связей:**
    URL: `/assignments`  
    Метод: `GET`
    Возвращает список всех связей, где каждое назначение содержит:
    - `id` — уникальный идентификатор связи
    - `machineId` — идентификатор машины, на которую назначен процесс
    - `processId` — идентификатор процесса

2.  **Добавление процесса:**
    URL: `/process/add  `
    Метод: `POST`
    Создаёт новый процесс с указанными ресурсными требованиями и пытается назначить его на подходящую машину.  
    Если подходящая машина не найдена или отсутствуют обязательные данные, возвращается сообщение об ошибке.
    # Тело запроса
    - Content-Type: application/json
    - Параметры:
    - `requiredMemory` (integer) — требуемая память для процесса
    - `requiredCpu` (integer) — требуемый объём CPU для процесса

3.  **Удаление процесса:**
    URL: `/process/delete/{id}` 
    Метод: `DELETE`
    Удаляет процесс по его идентификатору. Если у процесса есть назначение, оно также удаляется. После удаления вызывается процедура перераспределения назначений.
    # Параметры пути
    - `id` (integer) — идентификатор процесса, который необходимо удалить

4.  **Добавление машины:**
    URL: `/machine/add`  
    Метод: `POST`
    Создаёт новую машину с заданными ресурсами и вызывает перераспределение назначений для перераспределения процессов между машинами.
    # Тело запроса
    - Content-Type: application/json
    - Параметры:
    - `totalMemory` (integer) — общий объём памяти машины
    - `totalCpu` (integer) — общее количество CPU машины

5.  **Удаление машины:**
    URL: `/machine/delete/{id}` 
    Метод: `DELETE`
    Удаляет машину по её идентификатору. Все назначения, связанные с этой машиной, удаляются, а процессы перераспределяются на другие подходящие машины.
    # Параметры пути
    - `id` (integer) — идентификатор машины, которую необходимо удалить

## Вспомогательные методы (не являются публичными API)

1.  **findSuitableMachine**
    Определяет подходящую машину для размещения процесса, учитывая требования по памяти и CPU, а также исключая указанную машину (если требуется).
    Параметры:
    - `ProcessEntity` $process
    - `EntityManagerInterface` $em
    - `Machine`|null $excludeMachine (опционально)
    Возвращает:  
    Объект Machine или null, если подходящая машина не найдена.

2.  **rebalance**
    Перераспределяет все назначения. Удаляет текущие назначения, сортирует процессы по сумме требуемых ресурсов и заново распределяет их по машинам с наименьшей относительной нагрузкой.
    Параметры:
    - `EntityManagerInterface` $em
    Возвращает:  
    Ничего (void).
